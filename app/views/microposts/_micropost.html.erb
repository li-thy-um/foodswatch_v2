<% head_post = micropost %>
<% body_post = micropost %>
<% foot_post = micropost %>
<%
  roundor = if page == "comment"
    "line-above"
  else
    "img-rounded"
  end
%>
<div id="<%= micropost.id %>" style="margin-top:10px;background-color:#fff"
  class="<%= roundor %>">

  <!-- 转发 -->
  <% if micropost.original_id? %>
    <% head_post = micropost.original_post %>
    <% body_post = micropost.original_post %>
    <% foot_post = micropost.original_post %>
    <% line = "line-above" %>
    <div class="<%='div-hover div-click' if micropost.content != '#'%>">
      <span class="user">由 <%= user_link(micropost.user) %> 分享</span>
    </div>
    <% if micropost.content != "#" %>
      <div class="collapse">
        <div class="line-above row">
          <%= render 'microposts/post_head', post: micropost, page: page if
            ["feed", "comment", "show", "detail"].include?(page) %>
          <%= render 'microposts/post_body', post: micropost, page: page %>
        </div>
      </div>
    <% end %>
  <% end %>

  <!-- 原创 -->
  <div class="row <%= line %>">
    <%= render 'microposts/post_head', post: head_post, page: page if
    ["feed", "comment", "show", "detail"].include?(page) %>
    <%= render 'microposts/post_body', post: body_post, page: page %>
    <%= render 'microposts/post_foot', post: foot_post, page: page if
    ["feed", "comment", "show", "detail"].include?(page) %>
  </div>

<% if signed_in? && ["feed", "show", "detail"].include?(page) %>
  <% micropost = micropost.original_post if micropost.original_id? %>
  <%= render 'microposts/comment_collapse',
    micropost: micropost, page: page %>
<% end %>
</div>
